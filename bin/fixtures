<?php

use App\Entity\Category;
use App\Entity\Review;

require dirname(__DIR__) . '/vendor/autoload.php';
$entityManager = require dirname(__DIR__) . '/doctrine.php';

$categories = include 'DataFixtures/categories.php';
$reviews = include 'DataFixtures/reviews.php';

foreach ($categories as $data) {
    $category = new Category();
    $category->setName($data['name']);
    $category->setDescription($data['description']);
    $category->setUpdatedAt(new DateTime($data['updatedAt']));
    $category->setCreatedAt(new DateTime($data['createdAt']));

    $entityManager->persist($category);
    echo "Inserindo nova Categoria para testes..." . PHP_EOL;
}

foreach ($reviews as $data) {
    $review = new Review();
    $review->setUserId($data['userId']);
    $review->setAdvertisementId($data['advertisementId']);
    $review->setRating($data['rating']);
    $review->setComment($data['comment']);
    $review->setCreatedAt(new DateTime($data['createdAt']));
    $review->setUpdatedAt(new DateTime($data['updatedAt']));

    $entityManager->persist($review);
    echo "Inserindo nova Review para testes..." . PHP_EOL;
}

$entityManager->flush();
